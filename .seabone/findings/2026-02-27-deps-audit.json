[
  {
    "id": "deps-001",
    "severity": "critical",
    "category": "deps",
    "file": "pyproject.toml",
    "line": null,
    "status": "open",
    "issue": "python-jose 3.3.0 has a known algorithm confusion vulnerability (GHSA-cjwg-qfpm-7377) that allows JWT token forgery by substituting algorithm types. The project uses python-jose for all portal authentication (admin, customer, reseller, vendor). The package is also effectively unmaintained as of 2023.",
    "task": "Replace python-jose with PyJWT (actively maintained, CVE-clean). Update all JWT encode/decode calls in app/services/auth.py and related auth modules. PyJWT drop-in example: jwt.encode(payload, secret, algorithm='HS256') / jwt.decode(token, secret, algorithms=['HS256']).",
    "auto_fixable": false,
    "effort": "medium",
    "package": "python-jose",
    "current_version": "3.3.0",
    "latest_version": "3.3.0"
  },
  {
    "id": "deps-002",
    "severity": "high",
    "category": "deps",
    "file": "pyproject.toml",
    "line": null,
    "status": "fixed",
    "issue": "Jinja2 3.1.4 was affected by CVE-2024-56201 and CVE-2024-56326 (sandbox escape). Fixed in 3.1.5+.",
    "task": "Upgrade jinja2 to >=3.1.6 in pyproject.toml.",
    "auto_fixable": true,
    "effort": "trivial",
    "package": "jinja2",
    "current_version": "3.1.6",
    "latest_version": "3.1.6",
    "fixed_in": "PR #2"
  },
  {
    "id": "deps-003",
    "severity": "high",
    "category": "deps",
    "file": "pyproject.toml",
    "line": null,
    "status": "fixed",
    "issue": "cryptography 42.0.8 was significantly behind (46.x). Versions 43.xâ€“45.x addressed multiple CVEs including GHSA-h4gh-qq45-vh27 (Bleichenbacher oracle), RSA/EC key loading issues, and SSH certificate verification bypasses.",
    "task": "Upgrade cryptography to >=44.0.0 in pyproject.toml.",
    "auto_fixable": true,
    "effort": "small",
    "package": "cryptography",
    "current_version": "44.0.0",
    "latest_version": "46.0.5",
    "fixed_in": "PR #2"
  },
  {
    "id": "deps-004",
    "severity": "high",
    "category": "deps",
    "file": "pyproject.toml",
    "line": null,
    "status": "open",
    "issue": "passlib 1.7.4 is unmaintained (last PyPI release: 2020). The bcrypt backend emits deprecation warnings with modern bcrypt>=4.0, and no security patches will be issued. Passwords >72 bytes are silently truncated by the underlying bcrypt algorithm without passlib surfacing a warning.",
    "task": "Replace passlib with direct bcrypt usage (pip: bcrypt>=4.0) or argon2-cffi for new password hashing. Update all hash/verify calls in app/services/auth.py. Existing bcrypt hashes remain compatible when switching to raw bcrypt.checkpw().",
    "auto_fixable": false,
    "effort": "medium",
    "package": "passlib",
    "current_version": "1.7.4",
    "latest_version": "1.7.4"
  },
  {
    "id": "deps-005",
    "severity": "medium",
    "category": "deps",
    "file": "pyproject.toml",
    "line": null,
    "status": "fixed",
    "issue": "fastapi 0.111.0 was multiple minor versions behind (0.115.x). Later versions included fixes for request validation bypass and improved Pydantic v2 compatibility.",
    "task": "Upgrade fastapi to >=0.115.0 in pyproject.toml.",
    "auto_fixable": true,
    "effort": "small",
    "package": "fastapi",
    "current_version": "0.115.0",
    "latest_version": "0.115.x",
    "fixed_in": "agent/fix-deps-005"
  },
  {
    "id": "deps-006",
    "severity": "medium",
    "category": "deps",
    "file": "pyproject.toml",
    "line": null,
    "status": "fixed",
    "issue": "weasyprint 61.2 was outdated. Keeping it current minimises path traversal, SSRF, and resource exhaustion vulnerabilities in PDF generation.",
    "task": "Upgrade weasyprint to >=64.0 and pydyf to >=0.11.0.",
    "auto_fixable": true,
    "effort": "small",
    "package": "weasyprint",
    "current_version": "64.0",
    "latest_version": "64.x",
    "fixed_in": "PR #2 (inferred from changelog)"
  },
  {
    "id": "deps-007",
    "severity": "medium",
    "category": "deps",
    "file": "pyproject.toml",
    "line": null,
    "status": "fixed",
    "issue": "paramiko 3.4.1 was behind. Patch versions include host key verification improvements for network device SSH connections.",
    "task": "Upgrade paramiko to >=3.5.0 in pyproject.toml.",
    "auto_fixable": true,
    "effort": "trivial",
    "package": "paramiko",
    "current_version": "3.5.0",
    "latest_version": "3.5.x",
    "fixed_in": "PR #4"
  },
  {
    "id": "deps-008",
    "severity": "low",
    "category": "deps",
    "file": "pyproject.toml",
    "line": null,
    "status": "open",
    "issue": "pydantic 2.7.4 is behind 2.10.x. Newer versions include performance improvements, better model_rebuild() behaviour, and fixes for serialisation edge cases in discriminated unions.",
    "task": "Upgrade pydantic to >=2.10.0 in pyproject.toml. Check for deprecated validator patterns (v1-compat mode) in schemas after upgrade.",
    "auto_fixable": true,
    "effort": "trivial",
    "package": "pydantic",
    "current_version": "2.7.4",
    "latest_version": "2.10.x"
  },
  {
    "id": "deps-009",
    "severity": "low",
    "category": "deps",
    "file": "pyproject.toml",
    "line": null,
    "status": "open",
    "issue": "httpx 0.27.0 is behind 0.28.x. Minor version includes connection pool improvements and redirect handling fixes relevant to outbound CRM/webhook HTTP calls.",
    "task": "Upgrade httpx to >=0.28.0 in pyproject.toml.",
    "auto_fixable": true,
    "effort": "trivial",
    "package": "httpx",
    "current_version": "0.27.0",
    "latest_version": "0.28.x"
  },
  {
    "id": "deps-010",
    "severity": "low",
    "category": "deps",
    "file": "pyproject.toml",
    "line": null,
    "status": "open",
    "issue": "sqlalchemy 2.0.31 is behind the current 2.0 patch line (2.0.36+). Patch versions include ORM bug fixes, async session improvements, and mapped_column() edge case fixes.",
    "task": "Upgrade sqlalchemy to >=2.0.36 in pyproject.toml. Run full pytest suite after upgrade.",
    "auto_fixable": true,
    "effort": "trivial",
    "package": "sqlalchemy",
    "current_version": "2.0.31",
    "latest_version": "2.0.36+"
  },
  {
    "id": "deps-011",
    "severity": "low",
    "category": "deps",
    "file": "pyproject.toml",
    "line": null,
    "status": "open",
    "issue": "All opentelemetry packages are pinned at 1.26.0 / 0.47b0 from mid-2024. The instrumentation packages use a pre-release tag (0.47b0) which should be resolved to a stable release. Newer versions include span attribute fixes and improved FastAPI/SQLAlchemy instrumentation.",
    "task": "Upgrade all opentelemetry-* packages together to latest consistent stable release. Verify traces are exported correctly in staging after upgrade.",
    "auto_fixable": true,
    "effort": "small",
    "package": "opentelemetry-api",
    "current_version": "1.26.0",
    "latest_version": "1.31.x"
  },
  {
    "id": "deps-012",
    "severity": "low",
    "category": "deps",
    "file": "pyproject.toml",
    "line": null,
    "status": "open",
    "issue": "pip-audit is not installed/confirmed in CI. Without automated CVE scanning in CI, newly disclosed CVEs will not be caught automatically. Agent fix-deps-012 was spawned but merge not confirmed in git log.",
    "task": "Add pip-audit to dev dependencies: poetry add --group dev pip-audit. Add CI step: pip-audit --strict in the security stage alongside bandit. Verify .github/workflows or CI config includes the step.",
    "auto_fixable": false,
    "effort": "trivial",
    "package": "pip-audit",
    "current_version": "not installed",
    "latest_version": "2.x"
  }
]
