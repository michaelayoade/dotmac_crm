# DotMac CRM Environment Configuration Example
# Copy this file to .env and fill in secure values
#
# IMPORTANT: All secrets must be minimum 24 bytes (192 bits)
# Generate with: python3 -c "import secrets; import base64; print(base64.urlsafe_b64encode(secrets.token_bytes(32)).decode().rstrip('='))"

# =============================================================================
# Core Secrets (REQUIRED - min 24 bytes / 192 bits)
# =============================================================================
JWT_SECRET=<generate-32-byte-key>
TOTP_ENCRYPTION_KEY=<generate-32-byte-key>
WIREGUARD_KEY_ENCRYPTION_KEY=<generate-32-byte-key>
SESSION_SECRET=<generate-32-byte-key>

# =============================================================================
# Database Configuration
# =============================================================================
POSTGRES_USER=postgres
POSTGRES_PASSWORD=<generate-secure-password>
POSTGRES_DB=dotmac_crm
DATABASE_URL=postgresql+psycopg://postgres:<password>@db:5432/dotmac_crm
TEST_DATABASE_URL=postgresql+psycopg://postgres:<password>@db:5432/crm_test

# =============================================================================
# Redis Configuration
# =============================================================================
REDIS_PASSWORD=<generate-secure-password>
REDIS_URL=redis://:<password>@redis:6379/0
CELERY_BROKER_URL=redis://:<password>@redis:6379/0
CELERY_RESULT_BACKEND=redis://:<password>@redis:6379/1

# =============================================================================
# OpenBao (Vault-compatible secrets manager)
# =============================================================================
OPENBAO_ADDR=http://openbao:8200
OPENBAO_ROOT_TOKEN=<generate-secure-token>

# For production, use AppRole instead of root token:
# OPENBAO_ROLE_ID=<role-id>
# OPENBAO_SECRET_ID=<secret-id>

# =============================================================================
# JWT Configuration
# =============================================================================
JWT_ALGORITHM=HS256
JWT_ACCESS_TTL_MINUTES=15
JWT_REFRESH_TTL_DAYS=30

# =============================================================================
# Meta/Facebook Integration (optional)
# =============================================================================
META_APP_SECRET=
META_GRAPH_API_VERSION=v21.0

# =============================================================================
# WireGuard VPN Configuration
# =============================================================================
WIREGUARD_USE_NSENTER=1
VPN_BLOCKED_LAN_SUBNETS=172.20.255.0/24

# =============================================================================
# Application Settings
# =============================================================================
COMPANY_NAME=Dotmac
APP_URL=https://crm.dotmac.io
APP_ENV=development
DEBUG=true
LOG_LEVEL=INFO

# =============================================================================
# LLM Integration (OpenAI-compatible; e.g. DeepSeek API or self-hosted vLLM)
# =============================================================================
# LLM_PROVIDER=vllm
# Example (DeepSeek):
# VLLM_BASE_URL=https://api.deepseek.com
# VLLM_MODEL=deepseek-chat
# VLLM_API_KEY=
# VLLM_REQUIRE_API_KEY=true
# Example (Self-hosted vLLM):
# VLLM_BASE_URL=http://vllm:8000/v1
# VLLM_MODEL=qwen2.5-7b-instruct
# VLLM_REQUIRE_API_KEY=false

# =============================================================================
# Nominatim Geocoding (Nigeria by default)
# =============================================================================
NOMINATIM_URL=http://nominatim:8080

# =============================================================================
# Storage (Local or S3-compatible)
# =============================================================================
# Default is local filesystem under ./static (see STORAGE_LOCAL_ROOT).
#
# To use MinIO via docker-compose, start it with:
#   docker compose --profile s3 up -d minio
#
# Then set:
# STORAGE_BACKEND=s3
# S3_ENDPOINT_URL=http://minio:9000
# S3_ACCESS_KEY=minioadmin
# S3_SECRET_KEY=minioadmin
# S3_BUCKET=dotmac-uploads
# S3_PUBLIC_URL=http://localhost:9000
#
# For AWS S3:
# STORAGE_BACKEND=s3
# (leave S3_ENDPOINT_URL unset)
# S3_ACCESS_KEY=...
# S3_SECRET_KEY=...
# S3_REGION=us-east-1
# S3_BUCKET=...
# S3_PUBLIC_URL=https://<your-public-base-url>   # required if your UI/emails need a clickable public URL

# =============================================================================
# Email Configuration (optional)
# =============================================================================
# SMTP_HOST=smtp.example.com
# SMTP_PORT=587
# SMTP_USER=user@example.com
# SMTP_PASSWORD=<password>
# SMTP_FROM_EMAIL=noreply@example.com
# SMTP_FROM_NAME=DotMac CRM

# =============================================================================
# SMS Configuration (optional)
# =============================================================================
# TWILIO_ACCOUNT_SID=
# TWILIO_AUTH_TOKEN=
# TWILIO_PHONE_NUMBER=

# =============================================================================
# ERPNext Integration (optional)
# =============================================================================
# ERPNEXT_URL=https://erp.example.com
# ERPNEXT_API_KEY=<your-api-key>
# ERPNEXT_API_SECRET=<your-api-secret>

# =============================================================================
# MCP Server Configuration (Claude Code - read-only accounts)
# =============================================================================
# Read-only DB user for @bytebase/dbhub (create with scripts/setup_mcp_readonly.sh)
# DOTMAC_OMNI_DB_DSN=postgresql://claude_readonly:<password>@localhost:5432/dotmac_omni
# Read-only Redis credentials for redis-mcp-server
# MCP_REDIS_USERNAME=claude_readonly
# MCP_REDIS_PASSWORD=<password>

# =============================================================================
# Splynx Integration (optional)
# =============================================================================
# SPLYNX_CUSTOMER_SYNC_ENABLED=false
# SPLYNX_AUTH_TYPE=basic
# SPLYNX_BASE_URL=https://splynx.example.com
# SPLYNX_CUSTOMER_URL=https://splynx.example.com/api/2.0/admin/customers/customer
# SPLYNX_BASIC_AUTH_TOKEN=<base64-of-username:password>
# SPLYNX_TIMEOUT_SECONDS=30
