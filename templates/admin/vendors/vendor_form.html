{% extends "layouts/admin.html" %}

{% block title %}{{ 'Edit Vendor' if vendor else 'New Vendor' }} - Admin{% endblock %}

{% block content %}
<div class="mx-auto max-w-3xl space-y-6">
    <div>
        <h1 class="text-2xl font-bold text-slate-900 dark:text-white">{{ 'Edit Vendor' if vendor else 'Create Vendor' }}</h1>
        <p class="mt-1 text-sm text-slate-500 dark:text-slate-400">Register a contractor company for vendor portal access.</p>
    </div>

    {% if error %}
    <div class="rounded-lg border border-red-200 bg-red-50 p-4 text-sm text-red-700 dark:border-red-800 dark:bg-red-900/30 dark:text-red-200">
        {{ error }}
    </div>
    {% endif %}

    <form method="post" action="{{ action_url }}" x-data="{ createUser: false }" class="space-y-6 rounded-xl border border-slate-200 bg-white p-6 shadow-sm dark:border-slate-700 dark:bg-slate-800">
        <div class="grid gap-6 sm:grid-cols-2">
            <div>
                <label for="name" class="block text-sm font-medium text-slate-700 dark:text-slate-300">Vendor Name</label>
                <input type="text" name="name" id="name" required value="{{ vendor.name if vendor else '' }}" class="mt-2 block w-full rounded-lg border border-slate-300 bg-white px-3 py-2 text-sm focus:border-primary-500 focus:outline-none focus:ring-1 focus:ring-primary-500 dark:border-slate-600 dark:bg-slate-700 dark:text-white" />
            </div>
            <div>
                <label for="code" class="block text-sm font-medium text-slate-700 dark:text-slate-300">Vendor Code</label>
                <input type="text" name="code" id="code" value="{{ vendor.code if vendor else '' }}" class="mt-2 block w-full rounded-lg border border-slate-300 bg-white px-3 py-2 text-sm focus:border-primary-500 focus:outline-none focus:ring-1 focus:ring-primary-500 dark:border-slate-600 dark:bg-slate-700 dark:text-white" />
            </div>
            <div>
                <label for="contact_name" class="block text-sm font-medium text-slate-700 dark:text-slate-300">Contact Name</label>
                <input type="text" name="contact_name" id="contact_name" value="{{ vendor.contact_name if vendor else '' }}" class="mt-2 block w-full rounded-lg border border-slate-300 bg-white px-3 py-2 text-sm focus:border-primary-500 focus:outline-none focus:ring-1 focus:ring-primary-500 dark:border-slate-600 dark:bg-slate-700 dark:text-white" />
            </div>
            <div>
                <label for="contact_email" class="block text-sm font-medium text-slate-700 dark:text-slate-300">Contact Email</label>
                <input type="email" name="contact_email" id="contact_email" value="{{ vendor.contact_email if vendor else '' }}" class="mt-2 block w-full rounded-lg border border-slate-300 bg-white px-3 py-2 text-sm focus:border-primary-500 focus:outline-none focus:ring-1 focus:ring-primary-500 dark:border-slate-600 dark:bg-slate-700 dark:text-white" />
            </div>
            <div>
                <label for="contact_phone" class="block text-sm font-medium text-slate-700 dark:text-slate-300">Contact Phone</label>
                <input type="text" name="contact_phone" id="contact_phone" value="{{ vendor.contact_phone if vendor else '' }}" class="mt-2 block w-full rounded-lg border border-slate-300 bg-white px-3 py-2 text-sm focus:border-primary-500 focus:outline-none focus:ring-1 focus:ring-primary-500 dark:border-slate-600 dark:bg-slate-700 dark:text-white" />
            </div>
            <div>
                <label for="license_number" class="block text-sm font-medium text-slate-700 dark:text-slate-300">License Number</label>
                <input type="text" name="license_number" id="license_number" value="{{ vendor.license_number if vendor else '' }}" class="mt-2 block w-full rounded-lg border border-slate-300 bg-white px-3 py-2 text-sm focus:border-primary-500 focus:outline-none focus:ring-1 focus:ring-primary-500 dark:border-slate-600 dark:bg-slate-700 dark:text-white" />
            </div>
            <div class="sm:col-span-2">
                <label for="service_area" class="block text-sm font-medium text-slate-700 dark:text-slate-300">Service Area</label>
                <input type="text" name="service_area" id="service_area" value="{{ vendor.service_area if vendor else '' }}" class="mt-2 block w-full rounded-lg border border-slate-300 bg-white px-3 py-2 text-sm focus:border-primary-500 focus:outline-none focus:ring-1 focus:ring-primary-500 dark:border-slate-600 dark:bg-slate-700 dark:text-white" />
            </div>
        </div>

        <div>
            <label for="notes" class="block text-sm font-medium text-slate-700 dark:text-slate-300">Notes</label>
            <textarea name="notes" id="notes" rows="3" class="mt-2 block w-full rounded-lg border border-slate-300 bg-white px-3 py-2 text-sm focus:border-primary-500 focus:outline-none focus:ring-1 focus:ring-primary-500 dark:border-slate-600 dark:bg-slate-700 dark:text-white">{{ vendor.notes if vendor else '' }}</textarea>
        </div>

        <label class="flex items-center gap-2 text-sm text-slate-600 dark:text-slate-300">
            <input type="checkbox" name="is_active" class="h-4 w-4 rounded border-slate-300 text-primary-600 focus:ring-primary-500 dark:border-slate-600 dark:bg-slate-700" {% if vendor is none or vendor.is_active %}checked{% endif %} />
            Active vendor
        </label>

        {% if not vendor %}
        <div class="border-t border-slate-200 pt-6 dark:border-slate-700">
            <label class="flex items-center gap-2 text-sm font-medium text-slate-700 dark:text-slate-300">
                <input type="checkbox" name="create_user" x-model="createUser" class="h-4 w-4 rounded border-slate-300 text-primary-600 focus:ring-primary-500 dark:border-slate-600 dark:bg-slate-700" />
                Create login user now
            </label>

            <div class="mt-4 grid gap-4 sm:grid-cols-2">
                <div>
                    <label for="user_first_name" class="block text-sm font-medium text-slate-700 dark:text-slate-300">First Name</label>
                    <input type="text" name="user_first_name" id="user_first_name" :required="createUser" class="mt-2 block w-full rounded-lg border border-slate-300 bg-white px-3 py-2 text-sm focus:border-primary-500 focus:outline-none focus:ring-1 focus:ring-primary-500 dark:border-slate-600 dark:bg-slate-700 dark:text-white" />
                </div>
                <div>
                    <label for="user_last_name" class="block text-sm font-medium text-slate-700 dark:text-slate-300">Last Name</label>
                    <input type="text" name="user_last_name" id="user_last_name" :required="createUser" class="mt-2 block w-full rounded-lg border border-slate-300 bg-white px-3 py-2 text-sm focus:border-primary-500 focus:outline-none focus:ring-1 focus:ring-primary-500 dark:border-slate-600 dark:bg-slate-700 dark:text-white" />
                </div>
                <div>
                    <label for="user_email" class="block text-sm font-medium text-slate-700 dark:text-slate-300">Email</label>
                    <input type="email" name="user_email" id="user_email" :required="createUser" class="mt-2 block w-full rounded-lg border border-slate-300 bg-white px-3 py-2 text-sm focus:border-primary-500 focus:outline-none focus:ring-1 focus:ring-primary-500 dark:border-slate-600 dark:bg-slate-700 dark:text-white" />
                </div>
                <div>
                    <label for="user_username" class="block text-sm font-medium text-slate-700 dark:text-slate-300">Username</label>
                    <input type="text" name="user_username" id="user_username" :required="createUser" class="mt-2 block w-full rounded-lg border border-slate-300 bg-white px-3 py-2 text-sm focus:border-primary-500 focus:outline-none focus:ring-1 focus:ring-primary-500 dark:border-slate-600 dark:bg-slate-700 dark:text-white" />
                </div>
                <div>
                    <label for="user_password" class="block text-sm font-medium text-slate-700 dark:text-slate-300">Password</label>
                    <input type="password" name="user_password" id="user_password" :required="createUser" class="mt-2 block w-full rounded-lg border border-slate-300 bg-white px-3 py-2 text-sm focus:border-primary-500 focus:outline-none focus:ring-1 focus:ring-primary-500 dark:border-slate-600 dark:bg-slate-700 dark:text-white" />
                </div>
                <div>
                    <label for="user_role" class="block text-sm font-medium text-slate-700 dark:text-slate-300">Role (optional)</label>
                    <select name="user_role" id="user_role" class="mt-2 block w-full rounded-lg border border-slate-300 bg-white py-2 pl-3 pr-10 text-sm focus:border-primary-500 focus:outline-none focus:ring-1 focus:ring-primary-500 dark:border-slate-600 dark:bg-slate-700 dark:text-white">
                        <option value="">No role</option>
                        {% for role in roles | default([]) %}
                        <option value="{{ role.name }}">{{ role.name }}</option>
                        {% endfor %}
                    </select>
                </div>
            </div>
        </div>
        {% endif %}

        <div class="flex items-center justify-end gap-3">
            <a href="/admin/vendors" class="text-sm font-medium text-slate-600 hover:text-slate-900 dark:text-slate-300 dark:hover:text-white">Cancel</a>
            <button type="submit" class="inline-flex items-center rounded-lg bg-primary-600 px-4 py-2 text-sm font-semibold text-white shadow-sm hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2 dark:focus:ring-offset-slate-800">{{ 'Update Vendor' if vendor else 'Create Vendor' }}</button>
        </div>
    </form>
</div>
{% endblock %}
