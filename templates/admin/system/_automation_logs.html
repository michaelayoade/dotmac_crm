{% from "components/ui/macros.html" import table_shell, table_row, status_badge, empty_state %}
{% set pad = 'px-6 py-3' %}
{% call table_shell(table_id="automation-logs-table", title="Execution Logs", color="indigo", count=logs | length if logs else 0) %}
    <table class="min-w-full divide-y divide-slate-200 dark:divide-slate-700">
        <thead>
            <tr class="border-b border-slate-100 dark:border-slate-700/50">
                <th scope="col" class="{{ pad }} text-left text-xs font-semibold uppercase tracking-wider text-slate-500 dark:text-slate-400">Time</th>
                <th scope="col" class="{{ pad }} text-left text-xs font-semibold uppercase tracking-wider text-slate-500 dark:text-slate-400">Event</th>
                <th scope="col" class="{{ pad }} text-left text-xs font-semibold uppercase tracking-wider text-slate-500 dark:text-slate-400">Outcome</th>
                <th scope="col" class="{{ pad }} text-left text-xs font-semibold uppercase tracking-wider text-slate-500 dark:text-slate-400">Duration</th>
                <th scope="col" class="{{ pad }} text-left text-xs font-semibold uppercase tracking-wider text-slate-500 dark:text-slate-400">Error</th>
            </tr>
        </thead>
        <tbody class="divide-y divide-slate-100 dark:divide-slate-700/50">
            {% if logs %}
            {% for log in logs %}
            {% call table_row(color="indigo") %}
                <td class="{{ pad }} whitespace-nowrap text-sm text-slate-600 dark:text-slate-300">{{ log.created_at.strftime('%b %d, %Y %H:%M:%S') }}</td>
                <td class="{{ pad }} whitespace-nowrap">
                    <code class="rounded-lg bg-slate-100 px-2 py-1 text-xs font-semibold text-slate-700 dark:bg-slate-700 dark:text-slate-300">{{ log.event_type }}</code>
                </td>
                <td class="{{ pad }} whitespace-nowrap">
                    {% if log.outcome.value == 'success' %}
                    {{ status_badge("Success", "active", size="sm") }}
                    {% elif log.outcome.value == 'partial_failure' %}
                    {{ status_badge("Partial Failure", "warning", size="sm") }}
                    {% elif log.outcome.value == 'failure' %}
                    {{ status_badge("Failure", "danger", size="sm") }}
                    {% else %}
                    {{ status_badge("Skipped", "inactive", size="sm") }}
                    {% endif %}
                </td>
                <td class="{{ pad }} whitespace-nowrap">
                    <span class="text-sm font-medium text-slate-600 dark:text-slate-300">{{ log.duration_ms }}ms</span>
                </td>
                <td class="{{ pad }} text-sm text-slate-500 dark:text-slate-400 truncate max-w-xs">
                    {% if log.error %}
                    <span class="text-red-600 dark:text-red-400">{{ log.error }}</span>
                    {% endif %}
                </td>
            {% endcall %}
            {% endfor %}
            {% else %}
            <tr>
                <td colspan="5" class="px-6 py-12">
                    {{ empty_state("No execution logs yet", "Automation runs will appear here.") }}
                </td>
            </tr>
            {% endif %}
        </tbody>
    </table>
{% endcall %}
