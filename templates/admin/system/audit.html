{% extends "layouts/admin.html" %}
{% from "components/ui/macros.html" import page_header, submit_button %}

{% block title %}Audit Log - Admin{% endblock %}

{% block content %}
<div class="space-y-6">
    {{ page_header("Audit Log", "Track system changes and administrative activity", color="indigo", color2="violet", icon='<svg class="h-6 w-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01"/></svg>', breadcrumbs=[{"href": "/admin/system", "label": "System"}, {"href": "", "label": "Audit Log"}]) }}

    {# ── Filters ── #}
    <div class="animate-fade-in-up rounded-2xl border border-slate-200/60 bg-white p-5 shadow-sm dark:border-slate-700/60 dark:bg-slate-800" style="animation-delay: 75ms">
        <form id="audit-filters" hx-get="/admin/system/audit" hx-target="#audit-table" hx-trigger="submit, change from:select" class="flex flex-col gap-4 sm:flex-row sm:items-end">
            <div class="flex-1">
                <label class="block text-xs font-semibold uppercase tracking-wider text-slate-500 dark:text-slate-400 mb-2">Actor ID</label>
                <input type="text" name="actor_id" value="{{ actor_id | default('') }}" placeholder="UUID or system"
                    class="block w-full rounded-xl border border-slate-200 bg-slate-50/50 px-4 py-2.5 text-sm transition-all focus:border-indigo-500 focus:bg-white focus:outline-none focus:ring-2 focus:ring-indigo-500/20 dark:border-slate-600 dark:bg-slate-700/50 dark:text-white dark:focus:bg-slate-700">
            </div>
            <div class="w-full sm:w-40">
                <label class="block text-xs font-semibold uppercase tracking-wider text-slate-500 dark:text-slate-400 mb-2">Action</label>
                <input type="text" name="action" value="{{ action | default('') }}" placeholder="create, update"
                    class="block w-full rounded-xl border border-slate-200 bg-slate-50/50 px-4 py-2.5 text-sm transition-all focus:border-indigo-500 focus:bg-white focus:outline-none focus:ring-2 focus:ring-indigo-500/20 dark:border-slate-600 dark:bg-slate-700/50 dark:text-white dark:focus:bg-slate-700">
            </div>
            <div class="w-full sm:w-48">
                <label class="block text-xs font-semibold uppercase tracking-wider text-slate-500 dark:text-slate-400 mb-2">Entity</label>
                <input type="text" name="entity_type" value="{{ entity_type | default('') }}" placeholder="ticket, user"
                    class="block w-full rounded-xl border border-slate-200 bg-slate-50/50 px-4 py-2.5 text-sm transition-all focus:border-indigo-500 focus:bg-white focus:outline-none focus:ring-2 focus:ring-indigo-500/20 dark:border-slate-600 dark:bg-slate-700/50 dark:text-white dark:focus:bg-slate-700">
            </div>
            <div>
                {{ submit_button("Apply Filters", loading_label="Applying...") }}
            </div>
        </form>
    </div>

    {# ── Audit Table ── #}
    <div id="audit-table" class="animate-fade-in-up rounded-2xl border border-slate-200/60 bg-white shadow-sm dark:border-slate-700/60 dark:bg-slate-800" style="animation-delay: 150ms">
        {% include "admin/system/_audit_table.html" %}
    </div>
</div>
{% endblock %}
